%===============================================================================

%                                   NADPIS                      
\chapter{Úvod}
\label{uvod}


%                                   NADPIS                      
\chapter{Radio frekvenční identifikace}
\label{technologie_rfid}
V této kapitole jsou popsány principy komunikace pomocí radio frekvenční identifikace (dále jen RFID), její historie, jednotlivé komponenty a využití v průmyslu a každodenním životě.

\section{Úvod do RFID}
RFID je zkratka pro {Radio-Frequency IDentification}, tedy identifikace pomocí rádiové frekvence (dále jen RF). Tato technologie umožňuje bezdrátovou komunikaci na relativně krátkou vzdálenost\cite{The_RF_in_RFID}.
\par
RFID a bezdrátové technologie \cite{Smart_Cards_Tokens_Security}{ - str.321-347}

\section{Historie}
%\subsection{Čárové kódy}
Principy RFID byly poprvé použity v systému IFF (Identity: Friend or Foe) za 2. světové války Britskou armádou. Tento systém měl za úkol rozlišit vlastní letadla od nepřátelských. Proto byla vybavena nastavitelným {radio-majákem}, který byl schopen vysílat 6 identifikačních kódů. V padesátých letech minulého století se radio identifikace rozmohla z armády do celého letectví a používá se dodnes. %\cite{The_RF_in_RFID}\cite{Emulator_UHD_RFID_Tagu}.
\par
RFID vznikla jako alternativa k čárovým kódům. I když je výroba čárových kódů levnější, mají proti RFID mnoho nevýhod. Pro čtení musí čtecí zařízení přímo vidět na štítek s kódem. Nesmí být snížená jeho vizuální čitelnost, například špínou, popisovačem, nebo pokroucením. Zápis více informací se dá řešit pouze zvětšením plochy štítku, nebo použitím jemnějšího značení, které je ale viditelné z menší vzdálenosti. Modifikace dat uložených pomocí čárových kódů se dá prakticky řešit pouze tiskem nového kódu \cite{The_RF_in_RFID}\cite{Emulator_UHD_RFID_Tagu}.

\section{Tagy}
Primární využití RFID tagů spočívá v identifikaci objektů. Cena takových objektů je nesrovnatelně vyšší oproti ceně tagu. Pokud je značený objekt levný, tag musí být ještě levnější. Na rozdíl od RFID čteček jsou tagy prakticky pořád v pohybu, ať už jako chytré karty, nebo identifikátory zboží, vlaků kontejnerů apod. Tagy tedy musí být velmi levné za vysoké odolnosti proti fyzickému poškození\cite{The_RF_in_RFID}.
RFID tag je systém skládající se minimálně z mikročipu, antény a pouzdra. Mikročip obsahuje pamět a logické obvody pro příjímání a odesílání dat čtecímu zařízení. Anténa přijímá signál z čtečky a poté jej zpětně rozptýlí (dále jen backscatter modulace) odesílanými daty. Pouzdro je potřeba pro udržení integrity tagu a jako ochrana proti vnějšímu poškození samotného čipu a antény\cite{RFID_explained}.
RFID tagy se dělí na aktivní, pasivní a částečně pasivní podle toho zda je jsou napájeny z externího, nebo interního zdroje\cite{The_RF_in_RFID}. Rozdíl je také v tom, kdo iniciuje komunikaci. Aktivní tag komunikaci zahajuje sám, zatímco komunikaci s pasivními tagy musí zahájit sama čtečka\cite{Hazardous_areas}. 

\subsection{Pasivní tagy}
Pasivní tagy identifikují levné objekty. Interní zdroj, i ve formě malé baterie, je pro ně příliš velký a drahý. Stejně jako transmittery a příjímače používané v klasických radiových zařízeních. Bez konvenčního zdroje energie jsou prakticky použitelné pouze jednoduché obvody, které je možno napájet bezdrátově i na vzdálenost několika metrů od čtecího zařízení. 
\par 
Aby mohl integrovaný obvod tagu pracovat potřebuje zdroj stejnosměrného proudu několika desítek mikroampérů o napětí  jeden až tři volty v závislosti na typu použitých tranzistorů. Toto napětí musí tag získat z RF signálu\cite{The_RF_in_RFID}. Frekvence tohoto signálu se podle použití liší. Od použité frekvence se také odvíjí dosah čtení a rychlost přenosu dat. Používané frekvence spadají do několika pásem, a a to nízká frekvence ({Low Frequency - LF}), vysoká frekvence ({High Frequency - HF}) a ultra vysoká frekvence ({Ultra High Frequency - UHF}). Evropská a americká specifikace pásma UHF se liší ve frekvenci(viz. tabulka \ref{tabulka_pasem}). Chytré karty používají HF pásmo\cite{Smart_Cards_Tokens_Security}. 

\begin{table}[]
\begin{tabular}{cccc}
\hline
Pásmo               & Frekvence   & Dosah   & Přenosová rychlost \\ \hline
LF                  & 125-135 kHz & 1-2 m   & 100 bps            \\
HF                  & 13,56 MHz   & 2 m     & 2 kbps             \\
UHF-Evropa          & 865-868 MHz & 12-20 m & 40-640 kbps        \\
UHF-Severní Amerika & 902-928 MHz & 12-20 m & 40-640 kbps        \\ \hline
\end{tabular}
\caption{Porovnání vlastností operačních pásem RFID\cite{RFID_explained}\cite{The_RF_in_RFID}}
\label{tabulka_pasem}
\end{table}

\subsection{Aktivní tagy} %\par ?? 
Aktivní tagy jsou napájeny z vlastního zdroje. Ten může být buď baterie, nebo připojení do elektrické infrastruktury. Zdroj napájí nejenom přenos dat, ale i ostatní elektronické komponenty. Těmito komponentami mohou být různé senzory nebo uživatelské rozhraní\cite{RFID_explained}. Vzhledem k technologii logických obvodů postupuje vývoj baterií velmi pomalu. Jedním z hlavních problémů návrhu těchto tagů je tedy zkrácení doby aktivity a snížení energie potřebné jak pro aktivní, tak pro klidové období tagu. Technologické skloubení těchto požadavků není jednoduché a výroba tagů se do jisté míry podobá výrobě běžných rádiových zařízení. Diskrétní komponenty a integrované obvody připájené k tištěným spojům, to celé připojené k anténě a uložené v plastovém krytu\cite{The_RF_in_RFID}. 
Částečně pasivní tagy obsahují vnitřní zdroj pouze k napájení pomocných komponent. Data jsou přenášena pomocí backscatter modulace, jako u pasivních tagů\cite{Survey_of_RFID_Tags}.


\section{Čtecí zařízení}
Pro rádiovou komunikaci s tagy se používá čtecí zařízení, které funguje jako vysílač i příjímač dohromady. Taková zařízení komunikují buď plným, nebo polovičním duplexem. Poloduplexní spojení znamená, že zařízení nemůže přijímat a vysílat zároveň. Současný obousměrný přenos podporuje plný duplex. Pro komunikaci s pasivními tagy se používá právě plný duplex. Čtecí zařízení musí vysílat RF signál pro napájení tagu, a zároveň přijímat odpověď.
Nedílnou součástí čtecího zařízení je anténa. Vysílač i příjmač mohou mít každý svou anténu. Tato konfigurace je známá jako bistatická. Monostatický systém používá jednu anténu pro vysílání a přijímání signálu zároveň. V tomto případě je příjmač vystaven signálu z vysílače. Příjmač tedy musí být navržený tak, aby rozeznal signál z tagu\cite{The_RF_in_RFID}.\par

\section{Použití}

              
%                                   NADPIS                      
\chapter{Chytré karty MIFARE Classic\textsuperscript{\textregistered}}
\label{chytre_karty}
V této kapitole jsou popsány obecně chytré karty a jejich typy. Následuje představení značky MIFARE a karet MIFARE Classic. Na závěr budou představeny některé zranitelnosti těchto karet.

\section{Co jsou chytré karty}
Chytré karty, jak už název napovídá, jsou karty, které mohou být použity chytrým způsobem. Za chytrou kartu považujeme plastovou kartu s integrovaným obvodem. Takové karty lze obecně považovat za čipové karty, a ty mohou být v kontaktní, nebo bezkontaktní variantě. Kontaktní karty se vkládají do čtecích zařízení, které naváže fyzický kontakt se zlatě zbarveným rozhraním karty. Bezkontaktní karty stačí dostat do blízkosti čtecího zařízení. Napájení a komunikace je poté zajištěna pomocí RFID. Pod pojmem "chytrá karta" si obyčejně člověk představí platební kartu. Mohou ale být použity i ve formě elektronických pasů, občanských průkazů, přístupových karet, jako zabezpečení proti krádeži apod. Ne každá karta vyžaduje stejné zabezpečení. Některé ho nevyžadují vůbec. Například jednoduché tagy vysílající své ID jako inventarizační systém ve skladech. Jiné vyžadují složité  kryptografické mechanismy zajišťující soukromí přenášených dat. 
\par
Jednoduchý tag je nejméně zabezpečený z těchto produktů. Je nastaven tak, že své unikátní identifikační číslo (dále jen UID), které vysílá, je pouze pro čtení {(Read-only)}. Kromě vysílání svého UID nemá žádný jiný protokol, je tedy jednoduché odposlouchávat komunikaci a replikovat ji pomocí emulátoru. Místo speciálního emulátoru lze použít podobný tag, který umožnuje změnu svého UID.
\par
Paměťové tagy, stejně jako jednoduché, mají UID, navíc ale obsahují paměť. Tato paměť je jak pro čtení, tak pro zápis {(Read/Write)}. Její přenos není nijak šifrován, což může vést k neoprávněnému čtení, nebo emulaci. Výrobce karet může ovšem data opatřit ochranou integrity, například pomocí MAC (z anglického Message Authentication Code). Tato metoda zabrání útočníkovi ve vytváření nových a modifikaci stávajících dat. Je ale nutné opatřit čtecí zařízení funkcionalitou a klíči k ověření MAC\cite{Mifare_Classic_story}.
\par
Tag se zabezpečenou pamětí implementuje nějaký kryptografický protokol pro správu přístupu k paměti. Tag a čtecí zařízení se nejprve vzájemně autentizují, a teprve poté je povolen přístup k paměti. Data z paměti jsou před odesláním většinou nejprve zašifrována relačním klíčem, aby byla zajištěna jejich bezpečnost. Paměť některých tagů je rozdělena do menších oddílů, z nichž každý má vlastní klíč. Toto uspořádání umožňuje použít jeden tag k více aplikacím, přičemž každé aplikaci náleží jiný klíč.
\par
Nejpokročilejšími jsou zabezpečené tagy s mikrokontrolerem, který umožňuje nahrát různou funkcionalitu. Tyto tagy obvykle implementují bezpečnostní standardy jako například Global Platform. Šifrování, verifikace a další symetrické i asymetrické kryptografické metody jsou zajištěny kryptografickými koprocesory přímo na tagu\cite{Mifare_Classic_story}. Správný chod mikrokontroleru je zabezpečen například senzory vysokého a nízkého napětí, teploty, nebo frekvence, filtrem vstupu hodinového signálu, nebo aktivním stíněním\cite{NXP_Microcontroller_overview}.

\subsection{Message authentication code}
Message Authentication Code (dále jen MAC) je krátká informace odesílána s daty, která dokáže zajistit integritu a autenticitu dat. To znamená ověřit, že data byla odeslána důvěryhodným odesílatelem a nebyla nijak modifikována. Tato metoda se skládá ze tří algoritmů. První algoritmus generuje náhodné klíče z množiny klíčů. Druhý algoritmus ze vstupních dat a klíče vygeneruje MAC. A třetí algoritmus pomocí klíče a MAC verifikuje přijatá data\cite{Foundations_Of_Cryptography}.
\par

\section{MIFARE\textsuperscript{\textregistered}}
MIFARE\textsuperscript{\textregistered} je obchodní značka rakouské společnosti NXP Semiconductors, dříve známé pod jménem Philips Semiconductors. Tato značka zahrnuje množství proprietárních, bezdrátových řešení splňující mezinárodní standard ISO/IEC 14443. Produktová rodina zahrnuje čtyři typy karet. Zpětná kompatibilita zajišťuje bezproblémové přecházení na lépe zabezpečené produkty s více funkcemi. S více než 10 miliardami prodaných karet ovládá MIFARE zhruba 80\% světového trhu s bezdrátovýma chytrýma kartama. 
\cite{About_MIFARE}\cite{Dismantling_Mifare_Classic}.

\subsection{Standard ISO/IEC 14443}

\subsection{Varianty karet Mifare}

\begin{itemize}
  \item MIFARE Classic\textsuperscript{\textregistered}  
  \item MIFARE Plus\textsuperscript{\textregistered}  
  \item MIFARE DESFire\textsuperscript{\textregistered} 
  \item MIFARE Ultralight\textsuperscript{\textregistered}  
\end{itemize}

\par
Karty MIFARE Classic\textsuperscript{\textregistered} byly vyvinuty již v roce 1994 a brzy se staly úspěšným produktem. Původně byly navrženy jako karty se zabezpečenou pamětí. Byly proto používány v různých odvětvích, například v hromadné dopravě, ve školních kampusech nebo jako zaměstnanecké karty. Data a autentizace jsou šifrovány proprietární šifrou CRYPTO1. Zabezpečení ale není nejsilnější stránka těchto karet. Pro porovnání, i mnohem starší DES šifrování odolá o několik řádů delší čas útokům hrubou silou (brute force). Toho si je firma vědoma a nadále tyto karty nedoporučuje pro aplikace s důrazem na zabezpečení. Požadavky na bezpečnost vedly k vývoji dvou nových, lépe zabezpečených typů karet, MIFARE Plus a MIFARE DESFire\cite{Mifare_Classic_story}\cite{MIFARE_Classic_Official_about}. 
\par
Chytré karty MIFARE Plus jsou nástupcem karet Classic. Zpětná kompabilita je zajištěna podporou starší a méně bezpečnou šifrou CRYPTO1. Je tedy možné postupně modernizovat již zavedené systémy, ikdyž tento způsob neodstraňuje všechna rizika karet Classic. Nad to je implementována mnohem bezpečnější 128 bitová AES šifra\cite{MIFARE_Plus_Official}. Karty MIFARE DESFire už šifrování CRYPTO1 nepodporují vůbec. Naopak podporují šifrování DES a AES, komunikaci pomocí NFC a až 28 různých aplikací na jedné kartě\cite{MIFARE_DESFire_Official}. V České Republice je například používají České Dráhy ve svém produktu In Karta\cite{Ceske_Drahy_Podminky_InKarta}. Naopak Ultralight jsou velmi levné karty s krátkou životností a malou pamětí. Jsou vhodné pro jednorázové použití jako celodenní jízdenky nebo vstupenky na velké události\cite{MIFARE_Ultralight_Official}. Každá z těchto karet se dělí na další dva až čtyři podtypy, které se liší v různých parametrech, nebo nabízených vlastnostech karty.

\begin{table}[]
\begin{tabular}{cccc}
\hline
Produkt             & Classic     & Plus                    & DESFire                   & UltraLight    \\ \hline
Rychlost přenosu    & 106 kbps    & 106-848 kbps            & 106-848 kbps              & 106 kbps      \\
Velikost paměti     & 1-4 KB      & 2-4 KB                  & 256 B - 8 KB              & 40-144 B      \\
Šifrování           & CRYPTO1     & CRYPTO1, 128 bit AES    & 128 bit AES, 168 bit DES  & 112 bit DES   \\
Životnost           & 10 let      & 10 let                  & 10 let                    & 2 roky        \\
\end{tabular}
\caption{Porovnání jednotlivých MIFARE karet\cite{Vedeckotechnicky_sbornik_cd}}
\label{tabulka_MIFARE_karet}
\end{table}

%Historie chytrých karet \cite{Smart_card_handbook} {-} str. 37 ...
%Největší rozvoj hlavně v Německu a Francii\cite{Smart_card_handbook} {-} str. 38-40
%\par 
%Co jsou vlastně chytré karty \cite{Smart_Cards_Tokens_Security} {-} str. 34 ... 
%Použitá pamět EEPROM \cite{Smart_card_handbook} {- str. 39} ... 
%Typy chytrých karet\cite{Smart_card_handbook}{ - str. 41-43} \cite{Smart_Cards_Tokens_Security}{ - str. 34-40}


\par
%Výroba Smart karet \cite{Smart_Cards_Tokens_Security}{ - str. 58-80} ??



\section{Známé zranitelnosti}

%Smart Card Security \cite{Smart_Cards_Tokens_Security}{ - str. 224-254}


%                               NADPIS                      
\chapter{Zařízení Chameleon Mini}
\label{zarizeni_chameleon_mini}







\chapter{Závěr}
\label{zaver}


%===============================================================================
